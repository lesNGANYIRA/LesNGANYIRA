<!DOCTYPE html>
<html lang="rw">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-i18n="title">Les NGANYIRA â€” Tanga umusanzu</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    .lang-select{padding:8px 10px;border-radius:8px;border:1px solid #d8deea;background:#fff}
    .grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
    .card{background:#fff;border:1px solid #eef1f7;border-radius:14px;padding:14px}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    label{display:block;font-weight:600;margin-bottom:6px}
    input,select,textarea{width:100%;padding:10px;border:1px solid #d8deea;border-radius:10px}
    .muted small{color:var(--muted)}
    table.simple{width:100%;border-collapse:collapse}
    table.simple th,table.simple td{padding:8px;border-bottom:1px solid #eef1f7;text-align:left}
    .btn{padding:10px 12px;border-radius:10px;background:var(--accent);color:#fff;border:0;font-weight:700;text-decoration:none;cursor:pointer}
    .btn.secondary{background:#eef3ff;color:#1f3fb3}
    .kpi-grid{display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(180px,1fr))}
    .kpi{background:#fff;border:1px solid #eef1f7;border-radius:12px;padding:12px}
    .kpi .lbl{font-size:12px;color:#6b7280}
    .kpi .val{font-size:18px;font-weight:700}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#eef3ff;color:#1f3fb3;font-weight:600}
    .pay-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .pay-btn{border:1px solid #d8deea;background:#fff;border-radius:10px;padding:10px 12px;cursor:pointer;font-weight:700}
    .pay-btn.primary{background:var(--accent);color:#fff;border:0}
    .hidden{display:none}
  </style>
</head>
<body>
  <!-- NAV -->
  <header class="nav">
    <div class="nav-left" data-i18n="brand">Les NGANYIRA</div>
    <nav class="nav-right">
      <a href="home.html" data-i18n="nav.home">Ahabanza</a>
      <a href="about.html" data-i18n="nav.about">Ibyerekeye</a>
      <a href="services.html" data-i18n="nav.services">Serivisi</a>
      <a href="contribute.html" data-i18n="nav.contribute">Tanga umusanzu</a>
      <a href="terms.html" data-i18n="nav.terms">Amategeko & Politiki</a>
      <select id="langSel" class="lang-select" title="Language">
        <option value="rw">Kinyarwanda</option>
        <option value="en">English</option>
        <option value="fr">FranÃ§ais</option>
      </select>
      <button id="logoutBtn" class="nav-btn" data-i18n="nav.logout">Sohoka</button>
    </nav>
  </header>

  <div class="auth-card" style="margin-top:16px;">
    <h1 data-i18n="page.h1">Tanga umusanzu</h1>
    <p class="muted" data-i18n="page.lead">
      Hitamo fund, shyiramo umubare nâ€™ifaranga. Amafaranga abikwa kuri konti yawe ari uko kwishyura
      byagenze neza.
    </p>

    <div class="grid">
      <!-- Form -->
      <div class="card">
        <div class="row">
          <div style="flex:1 1 220px;min-width:220px">
            <label for="fund" data-i18n="form.fund">Fund</label>
            <select id="fund">
              <option value="savings" data-i18n="fund.savings">Kwigomwa & Kuzigamira</option>
              <option value="emergency" data-i18n="fund.emergency">Inkunga yâ€™ihutirwa</option>
              <option value="education" data-i18n="fund.education">Fonds yâ€™Uburezi</option>
              <option value="health" data-i18n="fund.health">Inkunga yâ€™Ubuvuzi</option>
              <option value="events" data-i18n="fund.events">Inkunga yâ€™ibirori</option>
              <option value="projects" data-i18n="fund.projects">Imishinga yâ€™iterambere</option>
            </select>
          </div>
          <div style="flex:1 1 180px;min-width:180px">
            <label for="amount" data-i18n="form.amount">Umubare</label>
            <input id="amount" type="number" inputmode="decimal" placeholder="0.00" step="0.01"/>
          </div>
          <div style="flex:1 1 140px;min-width:160px">
            <label for="currency" data-i18n="form.currency">Ifaranga</label>
            <select id="currency">
              <option value="CAD">CAD</option>
              <option value="USD">USD</option>
              <option value="EUR">EUR</option>
              <option value="GBP">GBP</option>
              <option value="RWF">RWF</option>
            </select>
          </div>
        </div>

        <div class="row" style="margin-top:10px">
          <div style="flex:1 1 220px">
            <label for="note" data-i18n="form.note">Icyo byagenewe / Icyitonderwa</label>
            <textarea id="note" rows="3" placeholder="(Optional)"></textarea>
          </div>
        </div>

        <div style="margin-top:10px">
          <div class="muted"><small data-i18n="form.preview">Igaragaza uko bihinduka:</small></div>
          <div id="preview" class="card" style="padding:10px;border-radius:10px;border:1px dashed #d8deea">â€”</div>
        </div>

        <div class="row" style="margin-top:12px">
          <span class="pill">ðŸ”’ <span data-i18n="pill.secure">Kwishyura bikorerwa ku rubuga rwâ€™umucuruzi wemewe (secure checkout)</span></span>
        </div>

        <div class="muted" style="margin-top:8px">
          <small data-i18n="form.ratesHint">Ingero z'ibiciro by'ivunjisha by'ubu: birashobora guhinduka.</small>
        </div>
      </div>

      <!-- Payment options -->
      <div class="card">
        <h2 data-i18n="pay.title">Hitamo aho uri nâ€™uburyo bwo kwishyura</h2>

        <div class="row">
          <div style="flex:1 1 220px">
            <label for="where" data-i18n="pay.where">Uritangaho he?</label>
            <select id="where">
              <option value="rwanda" data-i18n="pay.where.rw">Mu Rwanda</option>
              <option value="abroad" data-i18n="pay.where.abroad">Hanze yâ€™u Rwanda</option>
            </select>
          </div>
        </div>

        <!-- Rwanda methods -->
        <div id="methodsRw" class="pay-row" style="margin-top:8px">
          <button class="pay-btn" id="btnMtn">MTN MoMo</button>
          <button class="pay-btn" id="btnAirtel">Airtel Money</button>
          <button class="pay-btn primary" id="btnCardRw">Visa / Mastercard</button>
        </div>

        <!-- Abroad methods -->
        <div id="methodsAbroad" class="pay-row hidden" style="margin-top:8px">
          <button class="pay-btn primary" id="btnCardAbroad">Pay with Card</button>
        </div>

        <p class="muted" style="margin-top:10px">
          <small data-i18n="pay.note">Umusanzu ugaragara kuri konti yawe ari uko wishyuye neza (PAID).</small>
        </p>
      </div>

      <!-- Per-fund subtotals -->
      <div class="card">
        <h2 data-i18n="totals.title">Subtotals kuri buri fund (CAD)</h2>
        <div class="kpi-grid" id="fundTotals"></div>
      </div>

      <!-- Recent list -->
      <div class="card" style="grid-column:1 / -1">
        <h2 data-i18n="list.title">Contribution history (PAID)</h2>
        <div id="recentList" class="muted">â€”</div>
      </div>
    </div>
  </div>

  <footer style="max-width:1100px;margin:16px auto 8px;padding:12px;background:#fff;border:1px solid #eef1f7;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.04)">
    <div style="display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between">
      <div class="muted">
        <b data-i18n="footer.brand">Umuryango Les NGANYIRA</b> Â· <span data-i18n="footer.where">Kigali nâ€™ahandi hose</span>
        <br/><small><span data-i18n="footer.email">Email</span>: example@lesnganyira.org Â· <span data-i18n="footer.phone">Tel</span>: +250 7xx xxx xxx</small>
      </div>
      <div>
        <a href="terms.html" class="btn secondary" style="padding:8px 10px" data-i18n="footer.terms">Amategeko & Politiki</a>
        <a href="contribute.html" class="btn" style="padding:8px 10px" data-i18n="footer.contribute">Tanga umusanzu</a>
      </div>
    </div>
  </footer>

  <!-- Flutterwave Inline JS -->
  <script src="https://checkout.flutterwave.com/v3.js"></script>

  <script>
    // ===== Auth guard =====
    const email = localStorage.getItem("lng_current_user");
    if (!email) { window.location.href = "index.html"; }
    document.getElementById("logoutBtn")?.addEventListener("click", () => {
      localStorage.removeItem("lng_current_user");
      window.location.href = "index.html";
    });

    // ===== Helpers & storage =====
    function getContribs(){ try { return JSON.parse(localStorage.getItem("lng_contribs")||"{}"); } catch { return {}; } }
    function setContribs(db){ localStorage.setItem("lng_contribs", JSON.stringify(db)); }
    function fmtMoney(n){ return new Intl.NumberFormat(undefined,{minimumFractionDigits:2,maximumFractionDigits:2}).format(n); }

    // Sample conversion â†’ CAD
    const RATES_TO_CAD = { CAD:1, USD:1.34, EUR:1.45, GBP:1.70, RWF:0.0011 };

    const amountEl = document.getElementById("amount");
    const currencyEl = document.getElementById("currency");
    const noteEl = document.getElementById("note");
    const fundEl = document.getElementById("fund");
    const previewEl = document.getElementById("preview");
    const whereEl = document.getElementById("where");
    const methodsRw = document.getElementById("methodsRw");
    const methodsAbroad = document.getElementById("methodsAbroad");

    function renderPreview(){
      const amt = parseFloat(amountEl.value || "0");
      const cur = currencyEl.value;
      const fund = labelOfFund(fundEl.value);
      if (!amt || amt <= 0) { previewEl.textContent = "â€”"; return; }
      const cad = amt * (RATES_TO_CAD[cur] || 1);
      previewEl.textContent = `${fund}: ${fmtMoney(amt)} ${cur}  â†’  ${fmtMoney(cad)} CAD`;
    }
    amountEl.addEventListener("input", renderPreview);
    currencyEl.addEventListener("change", renderPreview);
    fundEl.addEventListener("change", renderPreview);
    whereEl.addEventListener("change", ()=>{
      const isRw = whereEl.value === "rwanda";
      methodsRw.classList.toggle("hidden", !isRw);
      methodsAbroad.classList.toggle("hidden", isRw);
    });

    // ===== WRITE ONLY AFTER PAID =====
    <script>
// ===== WRITE ONLY AFTER PAID =====
function addPaidContribution({fund, amount, currency, note, tx_ref}){
  const cad = amount * (RATES_TO_CAD[currency] || 1);
  const rec = {
    fund,
    amountOriginal: amount,
    currency,
    amountCAD: cad,
    note: (noteEl.value||"").trim(),
    at: Date.now(),
    status: "paid",
    approved: false,      // ðŸ”´ Nshyizeho: bizagaragara ari uko byemejwe
    tx_ref
  };
  const db = getContribs();
  db[email] = db[email] || [];
  db[email].push(rec);
  setContribs(db);
  renderList(); renderFundTotals(); renderPreview();
}
</script>


    // ===== FLUTTERWAVE INLINE (Card & Mobile Money Rwanda) =====
    // Public Key yawe (SANDBOX):
    const FLW_PUBLIC_KEY = "FLWPUBK_TEST-edf2892faa7c49620c914cff36f5f3c0-X";

    function baseCheckout(payload){
      const txRef = "LNG-" + Date.now(); // one tx_ref per attempt
      FlutterwaveCheckout({
        public_key: FLW_PUBLIC_KEY,
        tx_ref: txRef,
        amount: payload.amount,
        currency: payload.currency,
        payment_options: payload.payment_options, // "card" or "mobilemoneyrwanda"
        customer: payload.customer,               // {email, phonenumber, name}
        meta: { fund: payload.fund },
        customizations: {
          title: "Les NGANYIRA",
          description: "Contribution â€” " + labelOfFund(payload.fund)
        },
        callback: function (response) {
          // Only record when successful
          if ((response.status || "").toLowerCase() === "successful") {
            addPaidContribution({
              fund: payload.fund,
              amount: payload.amount,
              currency: payload.currency,
              tx_ref: response.tx_ref
            });
            alert(TR[langSel.value]["pay.success"]);
          } else {
            alert(TR[langSel.value]["pay.failed"] + " (" + (response.status||"") + ")");
          }
          window.location.href = "home.html";
        },
        onclose: function(){
          // User closed modal â€“ do nothing (no save)
        }
      });
    }

    function payWithCard(){
      const amt = parseFloat(amountEl.value||"0");
      if (!amt || amt<=0) { alert(TR[langSel.value]["pay.missAmt"]); return; }
      const users = JSON.parse(localStorage.getItem("lng_users")||"{}");
      const me = users[email] || {};
      baseCheckout({
        amount: amt,
        currency: currencyEl.value,       // Card: CAD/USD/EUR/GBP/RWF ... depending on your Flutterwave settings
        payment_options: "card",          // modal asks: cardholder name, number, expiry, CVV
        customer: { email, phonenumber: me.phone || "", name: me.name || email },
        fund: fundEl.value
      });
    }

    function payWithMoMoRw(network){
      const amt = parseFloat(amountEl.value||"0");
      if (!amt || amt<=0) { alert(TR[langSel.value]["pay.missAmt"]); return; }
      // MoMo Rwanda requires RWF
      if (currencyEl.value !== "RWF") {
        if (!confirm(TR[langSel.value]["pay.forceRwf"])) return;
        currencyEl.value = "RWF";
        renderPreview();
      }
      const users = JSON.parse(localStorage.getItem("lng_users")||"{}");
      const me = users[email] || {};
      if (!me.phone) { alert(TR[langSel.value]["pay.needPhone"]); return; }
      baseCheckout({
        amount: amt,
        currency: "RWF",
        payment_options: "mobilemoneyrwanda",
        customer: { email, phonenumber: me.phone, name: me.name || email },
        fund: fundEl.value
      });
    }

    document.getElementById("btnCardRw").addEventListener("click", payWithCard);
    document.getElementById("btnCardAbroad").addEventListener("click", payWithCard);
    document.getElementById("btnMtn").addEventListener("click", ()=> payWithMoMoRw("mtn"));
    document.getElementById("btnAirtel").addEventListener("click", ()=> payWithMoMoRw("airtel"));

    // Per-fund totals & list (PAID ONLY)
    const FUNDS = ["savings","emergency","education","health","events","projects"];
    function labelOfFund(code){
      const L = TR[langSel.value];
      const map = {savings:L["fund.savings"],emergency:L["fund.emergency"],education:L["fund.education"],health:L["fund.health"],events:L["fund.events"],projects:L["fund.projects"]};
      return map[code] || code;
    }

    function renderFundTotals(){
      const db = getContribs(); const rows = (db[email]||[]);
      const totals = FUNDS.reduce((o,k)=> (o[k]=0, o), {});
      rows.forEach(r => {
        if ((r.status||"") === "paid") {
          totals[r.fund||"savings"] += Number(r.amountCAD)||0;
        }
      });
      const wrap = document.getElementById("fundTotals");
      let html = "";
      FUNDS.forEach(k=>{
        html += `<div class="kpi"><div class="lbl">${labelOfFund(k)}</div><div class="val">${fmtMoney(totals[k])} CAD</div></div>`;
      });
      wrap.innerHTML = html;
    }

    function renderList(){
      const db = getContribs();
      const rowsAll = (db[email] || []);
      const rows = rowsAll.filter(r => (r.status||"") === "paid").slice().reverse();
      const box = document.getElementById("recentList");
      const L = TR[langSel.value];
      if (!rows.length) { box.textContent = L["list.empty"]; return; }
      let html = '<div style="overflow:auto;"><table class="simple">';
      html += `<thead><tr>
        <th>${L["tbl.date"]}</th>
        <th>${L["tbl.fund"]}</th>
        <th>${L["tbl.original"]}</th>
        <th>${L["tbl.cad"]}</th>
        <th>${L["tbl.note"]}</th>
        <th>Ref</th>
      </tr></thead><tbody>`;
      rows.slice(0,12).forEach(r=>{
        const d = new Date(r.at).toLocaleString();
        html += `<tr>
          <td>${d}</td>
          <td>${labelOfFund(r.fund||"savings")}</td>
          <td>${fmtMoney(r.amountOriginal)} ${r.currency}</td>
          <td>${fmtMoney(r.amountCAD)} CAD</td>
          <td>${r.note || ""}</td>
          <td>${r.tx_ref || ""}</td>
        </tr>`;
      });
      html += '</tbody></table></div>';
      box.innerHTML = html;
    }

    // ===== i18n (RW/EN/FR) =====
    const TR = {
      rw:{
        brand:"Les NGANYIRA",
        title:"Les NGANYIRA â€” Tanga umusanzu",
        "nav.home":"Ahabanza","nav.about":"Ibyerekeye","nav.services":"Serivisi","nav.contribute":"Tanga umusanzu","nav.terms":"Amategeko & Politiki","nav.logout":"Sohoka",
        "page.h1":"Tanga umusanzu",
        "page.lead":"Hitamo fund, shyiramo umubare nâ€™ifaranga. Amafaranga abikwa kuri konti yawe ari uko kwishyura byagenze neza.",
        "form.fund":"Fund",
        "fund.savings":"Kwigomwa & Kuzigamira","fund.emergency":"Inkunga yâ€™ihutirwa","fund.education":"Fonds yâ€™Uburezi","fund.health":"Inkunga yâ€™Ubuvuzi","fund.events":"Inkunga yâ€™ibirori","fund.projects":"Imishinga yâ€™iterambere",
        "form.amount":"Umubare","form.currency":"Ifaranga","form.note":"Icyo byagenewe / Icyitonderwa","form.preview":"Igaragaza uko bihinduka:","form.ratesHint":"Ingero z'ibiciro by'ivunjisha by'ubu: birashobora guhinduka.",
        "totals.title":"Subtotals kuri buri fund (CAD)","list.title":"Contribution history (PAID)","list.empty":"Nta byishuwe biragaragara.",
        "tbl.date":"Itariki","tbl.fund":"Fund","tbl.original":"Byatangirijweho","tbl.cad":"Mu CAD","tbl.note":"Ibisobanuro",
        "pay.title":"Hitamo aho uri nâ€™uburyo bwo kwishyura","pay.where":"Uritangaho he?","pay.where.rw":"Mu Rwanda","pay.where.abroad":"Hanze yâ€™u Rwanda",
        "pay.note":"Umusanzu ugaragara kuri konti yawe ari uko wishyuye neza (PAID).",
        "pay.missAmt":"Shyiramo umubare wemewe mbere yo kwishyura.",
        "pay.forceRwf":"Rwanda Mobile Money isaba RWF. Uhindure ifaranga kuri RWF?",
        "pay.needPhone":"Shyiramo numero ya telefoni (profile) kugira ngo MoMo ikore.",
        "pay.success":"Murakoze! Kwishyura byagenze neza.",
        "pay.failed":"Kwishyura byanze",
        "pill.secure":"Kwishyura bikorerwa ku rubuga rwâ€™umucuruzi wemewe (secure checkout)",
        "footer.brand":"Umuryango Les NGANYIRA","footer.where":"Kigali nâ€™ahandi hose","footer.email":"Email","footer.phone":"Tel","footer.terms":"Amategeko & Politiki","footer.contribute":"Tanga umusanzu"
      },
      en:{
        brand:"Les NGANYIRA",
        title:"Les NGANYIRA â€” Make a Contribution",
        "nav.home":"Home","nav.about":"About","nav.services":"Services","nav.contribute":"Make a Contribution","nav.terms":"Terms & Policies","nav.logout":"Log out",
        "page.h1":"Make a Contribution",
        "page.lead":"Choose a fund, enter amount and currency. Records appear only after a successful payment.",
        "form.fund":"Fund",
        "fund.savings":"Saving & Contributions","fund.emergency":"Emergency Support","fund.education":"Education Fund","fund.health":"Health Support","fund.events":"Events Support","fund.projects":"Development Projects",
        "form.amount":"Amount","form.currency":"Currency","form.note":"Purpose / Note","form.preview":"Conversion preview:","form.ratesHint":"Sample exchange rates; may change.",
        "totals.title":"Per-fund subtotals (CAD)","list.title":"Contribution history (PAID)","list.empty":"No paid contributions yet.",
        "tbl.date":"Date","tbl.fund":"Fund","tbl.original":"Original","tbl.cad":"In CAD","tbl.note":"Note",
        "pay.title":"Where are you paying from & method","pay.where":"Where are you?","pay.where.rw":"In Rwanda","pay.where.abroad":"Outside Rwanda",
        "pay.note":"Your record is saved only after a successful payment.",
        "pay.missAmt":"Please enter a valid amount before paying.",
        "pay.forceRwf":"Rwanda Mobile Money requires RWF. Switch currency to RWF?",
        "pay.needPhone":"Please add your phone number (profile) to use Mobile Money.",
        "pay.success":"Thank you! Payment successful.",
        "pay.failed":"Payment failed",
        "pill.secure":"Payment happens on a certified provider (secure checkout)",
        "footer.brand":"Les NGANYIRA Family","footer.where":"Kigali & worldwide","footer.email":"Email","footer.phone":"Phone","footer.terms":"Terms & Policies","footer.contribute":"Contribute"
      },
      fr:{
        brand:"Les NGANYIRA",
        title:"Les NGANYIRA â€” Faire une contribution",
        "nav.home":"Accueil","nav.about":"Ã€ propos","nav.services":"Services","nav.contribute":"Faire une contribution","nav.terms":"Conditions & Politiques","nav.logout":"DÃ©connexion",
        "page.h1":"Faire une contribution",
        "page.lead":"Choisissez un fonds, saisissez le montant et la devise. Lâ€™enregistrement apparaÃ®t uniquement aprÃ¨s un paiement rÃ©ussi.",
        "form.fund":"Fonds",
        "fund.savings":"Ã‰pargne & Contributions","fund.emergency":"Soutien dâ€™urgence","fund.education":"Fonds Ã‰ducation","fund.health":"Soutien SantÃ©","fund.events":"Soutien Ã‰vÃ©nements","fund.projects":"Projets de dÃ©veloppement",
        "form.amount":"Montant","form.currency":"Devise","form.note":"Objet / Note","form.preview":"AperÃ§u de conversion :","form.ratesHint":"Taux de change dâ€™exemple ; susceptibles dâ€™Ã©voluer.",
        "totals.title":"Sous-totaux par fonds (CAD)","list.title":"Historique des contributions (PAYÃ‰)","list.empty":"Aucune contribution payÃ©e.",
        "tbl.date":"Date","tbl.fund":"Fonds","tbl.original":"Original","tbl.cad":"En CAD","tbl.note":"Note",
        "pay.title":"OÃ¹ payez-vous et mÃ©thode","pay.where":"Vous Ãªtes oÃ¹ ?","pay.where.rw":"Au Rwanda","pay.where.abroad":"Hors du Rwanda",
        "pay.note":"Lâ€™enregistrement est sauvegardÃ© uniquement aprÃ¨s un paiement rÃ©ussi.",
        "pay.missAmt":"Veuillez saisir un montant valide avant de payer.",
        "pay.forceRwf":"Le Mobile Money Rwanda nÃ©cessite le RWF. Passer la devise en RWF ?",
        "pay.needPhone":"Veuillez ajouter votre numÃ©ro de tÃ©lÃ©phone (profil) pour utiliser Mobile Money.",
        "pay.success":"Merci ! Paiement rÃ©ussi.",
        "pay.failed":"Paiement Ã©chouÃ©",
        "pill.secure":"Le paiement se fait chez un prestataire certifiÃ© (checkout sÃ©curisÃ©)",
        "footer.brand":"Famille Les NGANYIRA","footer.where":"Kigali & dans le monde","footer.email":"Email","footer.phone":"TÃ©l.","footer.terms":"Conditions & Politiques","footer.contribute":"Contribuer"
      }
    };

    function applyLang(lang){
      const dict = TR[lang] || TR.rw;
      document.querySelectorAll("[data-i18n]").forEach(el=>{
        const key = el.getAttribute("data-i18n");
        if (dict[key]) el.textContent = dict[key];
      });
      document.title = dict["title"] || "Les NGANYIRA â€” Contribution";
      document.documentElement.setAttribute("lang", lang);
      localStorage.setItem("lng_lang", lang);
      renderPreview(); renderList(); renderFundTotals();
    }
    const langSel = document.getElementById("langSel");
    const savedLang = localStorage.getItem("lng_lang") || "rw";
    langSel.value = savedLang;
    langSel.addEventListener("change", ()=> applyLang(langSel.value));
    applyLang(savedLang);

    // Initial render
    renderPreview(); renderList(); renderFundTotals();
  </script>
</body>
</html>
