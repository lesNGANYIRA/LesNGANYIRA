<!DOCTYPE html>
<html lang="rw">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Les NGANYIRA — Home</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    /* Hero & cards */
    .hero { position: relative; width: 100%; max-width: 1100px; margin: 8px auto 0;
      border-radius: 16px; overflow: hidden; box-shadow: 0 8px 20px rgba(0,0,0,.08);
      background: #000; color: #fff; }
    .hero img { width: 100%; height: 260px; object-fit: cover; opacity: .85; display: block; }
    .overlay { position: absolute; inset: 0; display: flex; flex-direction: column; justify-content: flex-end;
      padding: 18px; background: linear-gradient(180deg, rgba(0,0,0,0) 40%, rgba(0,0,0,.45) 100%); }
    .overlay h1 { margin: 0 0 6px; font-size: 26px; }
    .overlay p  { margin: 0 0 10px; color: #e5e7eb; }
    .btn-row { display: flex; gap: 8px; }
    .btn { padding: 10px 12px; border-radius: 10px; background: var(--accent); color: #fff; text-decoration: none; font-weight: 600; }
    .btn.secondary { background: #eef3ff; color: #1f3fb3; }

    .quick { display: grid; gap: 12px; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); margin-top: 16px; }
    .card { background: #fff; border: 1px solid #eef1f7; border-radius: 14px; padding: 14px; }
    table.simple { width:100%; border-collapse:collapse; }
    table.simple th, table.simple td { padding:8px; border-bottom:1px solid #eef1f7; text-align:left; }

    /* Language switch */
    .lang-select { padding: 8px 10px; border-radius: 8px; border: 1px solid #d8deea; background: #fff; }
  </style>
</head>
<body>
  <!-- NAV -->
  <header class="nav">
    <div class="nav-left" data-i18n="brand">Les NGANYIRA</div>
    <nav class="nav-right">
      <a href="home.html" data-i18n="nav.home">Ahabanza</a>
      <a href="about.html" data-i18n="nav.about">Ibyerekeye</a>
      <a href="services.html" data-i18n="nav.services">Serivisi</a>
      <a href="contribute.html" data-i18n="nav.contribute">Tanga umusanzu</a>
      <a href="terms.html" data-i18n="nav.terms">Amategeko & Politiki</a>
      <select id="langSel" class="lang-select" title="Language">
        <option value="rw">Kinyarwanda</option>
        <option value="en">English</option>
        <option value="fr">Français</option>
      </select>
      <button id="logoutBtn" class="nav-btn" data-i18n="nav.logout">Sohoka</button>
    </nav>
  </header>

  <!-- HERO -->
  <section class="hero">
    <!-- Shyira iyi foto muri repo yawe: /images/EIDS5199.JPG -->
    <img src="./images/EIDS5199.JPG" alt="Les NGANYIRA hero"/>
    <div class="overlay">
      <h1 data-i18n="hero.title">Twunze ubumwe ku hazaza heza</h1>
      <p data-i18n="hero.tagline">Kuzigama. Gufashanya. Gukura hamwe.</p>
      <div class="btn-row">
        <a href="contribute.html" class="btn" data-i18n="hero.ctaContribute">Tanga umusanzu</a>
        <a href="services.html" class="btn secondary" data-i18n="hero.ctaServices">Reba serivisi</a>
      </div>
    </div>
  </section>

  <div class="auth-card" style="margin-top:16px;">
    <!-- Quick intro & stats -->
    <div class="quick">
      <div class="card">
        <h2 data-i18n="welcome.title">Murakaza neza</h2>
        <p id="welcomeTxt" class="muted"></p>
      </div>

      <div class="card">
        <h2 data-i18n="stats.title">Imibare yihuse</h2>
        <div class="muted"><small data-i18n="stats.totalLabel">Umusanzu wose (CAD)</small></div>
        <div id="totalCad" style="font-size:20px;font-weight:700;">0.00</div>
        <div class="muted" style="margin-top:6px;">
          <small><span data-i18n="stats.entries">Ibyinjijwe:</span> <span id="totalCount">0</span></small>
        </div>
      </div>

      <div class="card">
        <h2 data-i18n="ann.title">Amatangazo</h2>
        <ul class="muted" style="margin:6px 0 0 18px;" id="annList">
          <li data-i18n="ann.item1">Kwibutsa kwizigamira: tariki 25 buri kwezi.</li>
          <li data-i18n="ann.item2">Telephone y’umuryango — Ku cyumweru 7:00 PM Kigali.</li>
        </ul>
      </div>
    </div>

    <!-- Family goal -->
    <div class="card" style="margin-top:12px;">
      <h2 data-i18n="goal.title">Intego y’umuryango</h2>
      <p class="muted"><small data-i18n="goal.monthTarget">Intego y’ukwezi:</small> <b id="goalTargetLabel"></b></p>
      <div style="height:12px;background:#eef1f7;border-radius:999px;overflow:hidden;">
        <div id="goalBar" style="height:100%;width:0%;background:#2f6bff;"></div>
      </div>
      <p class="muted" style="margin-top:6px;">
        <small><span data-i18n="goal.raised">Bimaze gukusanywa:</span> <b id="goalRaised"></b> — <span id="goalPct"></span> <span data-i18n="goal.ofTarget">by’intego</span></small>
      </p>
    </div>

    <!-- How it works -->
    <div class="card" style="margin-top:12px;">
      <h2 data-i18n="how.title">Uko bikora</h2>
      <ol class="muted" style="margin:6px 0 0 18px;">
        <li data-i18n="how.step1">Fungura konti ukoresheje email na numero ya telefone.</li>
        <li data-i18n="how.step2">Tanga umusanzu mu mafaranga ushaka (urahita uhindurwa mu CAD).</li>
        <li data-i18n="how.step3">Reba aho tugeze ku ntego kuri Dashboard no kuri Ahabanza.</li>
      </ol>
    </div>

    <!-- FAQ -->
    <div class="card" style="margin-top:12px;">
      <h2 data-i18n="faq.title">Ibibazo bikunze kubazwa</h2>

      <details>
        <summary data-i18n="faq.q1">Aho amakuru yanjye abikwa ni hehe?</summary>
        <p class="muted" data-i18n="faq.a1">Abikwa kuri mudasobwa/telefone ukoresha (LocalStorage). Tuzashyiraho uburyo bwa online kugira ngo bibonekere ku bikoresho byose ukoresheje konti yawe.</p>
      </details>

      <details>
        <summary data-i18n="faq.q2">Ni ubuhe bwoko bw’amafaranga nshobora gukoresha?</summary>
        <p class="muted" data-i18n="faq.a2">EUR, GBP, CAD, RWF, USD — byose bihindurwa mu CAD ako kanya.</p>
      </details>

      <details>
        <summary data-i18n="faq.q3">Nshobora guhindura cyangwa gusiba umusanzu?</summary>
        <p class="muted" data-i18n="faq.a3">Ubu tubika muri device yawe. Dushobora kongeramo guhindura/gusiba no kubika ku rubuga (cloud) mu byiciro bikurikira.</p>
      </details>
    </div>

    <!-- Recent contributions -->
    <div class="card" style="margin-top:12px;">
      <h2 data-i18n="recent.title">Ibyaheruka kwinjizwa</h2>
      <div id="recentList" class="muted">
        <span data-i18n="recent.none">Nta byinjijwe birabikwa.</span>
        <a href="contribute.html" data-i18n="recent.add">Ongeraho →</a>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer style="max-width:1100px;margin:16px auto 8px;padding:12px;background:#fff;border:1px solid #eef1f7;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.04);">
    <div style="display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;">
      <div class="muted">
        <b data-i18n="footer.brand">Umuryango Les NGANYIRA</b> · <span data-i18n="footer.where">Kigali n’ahandi hose</span>
        <br/><small><span data-i18n="footer.email">Email</span>: example@lesnganyira.org · <span data-i18n="footer.phone">Tel</span>: +250 7xx xxx xxx</small>
      </div>
      <div>
        <a href="terms.html" class="btn secondary" style="padding:8px 10px;" data-i18n="footer.terms">Amategeko & Politiki</a>
        <a href="contribute.html" class="btn" style="padding:8px 10px;" data-i18n="footer.contribute">Tanga umusanzu</a>
      </div>
    </div>
  </footer>

  <script>
    // ===== Auth guard & helpers =====
    function getUsers(){ try { return JSON.parse(localStorage.getItem("lng_users")||"{}"); } catch { return {}; } }
    function getContribs(){ try { return JSON.parse(localStorage.getItem("lng_contribs")||"{}"); } catch { return {}; } }
    function fmtMoney(n){ return new Intl.NumberFormat(undefined,{minimumFractionDigits:2,maximumFractionDigits:2}).format(n); }

    const email = localStorage.getItem("lng_current_user");
    if (!email) { window.location.href = "index.html"; }

    const users = getUsers();
    const me = users[email];
    if (!me) {
      localStorage.removeItem("lng_current_user");
      localStorage.removeItem("lng_remember");
      window.location.href = "index.html";
    }

    document.getElementById("logoutBtn").addEventListener("click", () => {
      localStorage.removeItem("lng_current_user");
      window.location.href = "index.html";
    });

    // ===== Language (RW/EN/FR) =====
    const TR = {
      rw: {
        brand: "Les NGANYIRA",
        "nav.home":"Ahabanza","nav.about":"Ibyerekeye","nav.services":"Serivisi","nav.contribute":"Tanga umusanzu","nav.terms":"Amategeko & Politiki","nav.logout":"Sohoka",
        "hero.title":"Twunze ubumwe ku hazaza heza","hero.tagline":"Kuzigama. Gufashanya. Gukura hamwe.","hero.ctaContribute":"Tanga umusanzu","hero.ctaServices":"Reba serivisi",
        "welcome.title":"Murakaza neza",
        "stats.title":"Imibare yihuse","stats.totalLabel":"Umusanzu wose (CAD)","stats.entries":"Ibyinjijwe:",
        "ann.title":"Amatangazo","ann.item1":"Kwibutsa kwizigamira: tariki 25 buri kwezi.","ann.item2":"Telephone y’umuryango — Ku cyumweru 7:00 PM Kigali.",
        "goal.title":"Intego y’umuryango","goal.monthTarget":"Intego y’ukwezi:","goal.raised":"Bimaze gukusanywa:","goal.ofTarget":"by’intego",
        "how.title":"Uko bikora","how.step1":"Fungura konti ukoresheje email na numero ya telefone.","how.step2":"Tanga umusanzu mu mafaranga ushaka (urahita uhindurwa mu CAD).","how.step3":"Reba aho tugeze ku ntego kuri Dashboard no kuri Ahabanza.",
        "faq.title":"Ibibazo bikunze kubazwa","faq.q1":"Aho amakuru yanjye abikwa ni hehe?","faq.a1":"Abikwa kuri mudasobwa/telefone ukoresha (LocalStorage). Tuzashyiraho uburyo bwa online kugira ngo bibonekere ku bikoresho byose ukoresheje konti yawe.",
        "faq.q2":"Ni ubuhe bwoko bw’amafaranga nshobora gukoresha?","faq.a2":"EUR, GBP, CAD, RWF, USD — byose bihindurwa mu CAD ako kanya.","faq.q3":"Nshobora guhindura cyangwa gusiba umusanzu?","faq.a3":"Ubu tubika muri device yawe. Dushobora kongeramo guhindura/gusiba no kubika ku rubuga (cloud) mu byiciro bikurikira.",
        "recent.title":"Ibyaheruka kwinjizwa","recent.none":"Nta byinjijwe birabikwa.","recent.add":"Ongeraho →",
        "footer.brand":"Umuryango Les NGANYIRA","footer.where":"Kigali n’ahandi hose","footer.email":"Email","footer.phone":"Tel"
      },
      en: {
        brand:"Les NGANYIRA",
        "nav.home":"Home","nav.about":"About","nav.services":"Services","nav.contribute":"Make a Contribution","nav.terms":"Terms & Policies","nav.logout":"Log out",
        "hero.title":"United for our future","hero.tagline":"Save. Support. Grow — together.","hero.ctaContribute":"Make a Contribution","hero.ctaServices":"See Services",
        "welcome.title":"Welcome",
        "stats.title":"Quick stats","stats.totalLabel":"Total contributions (CAD)","stats.entries":"Entries:",
        "ann.title":"Announcements","ann.item1":"Monthly saving reminder: 25th.","ann.item2":"Family call — Sunday 7:00 PM Kigali.",
        "goal.title":"Family goal","goal.monthTarget":"Monthly target:","goal.raised":"Raised:","goal.ofTarget":"of target",
        "how.title":"How it works","how.step1":"Create an account with email and phone.","how.step2":"Contribute in any currency (auto-converted to CAD).","how.step3":"Track progress on Dashboard and Home.",
        "faq.title":"FAQ","faq.q1":"Where is my data stored?","faq.a1":"On your device (LocalStorage). We’ll add online sync so it’s accessible across devices.","faq.q2":"Which currencies can I use?","faq.a2":"EUR, GBP, CAD, RWF, USD — all converted to CAD instantly.","faq.q3":"Can I edit or delete a contribution?","faq.a3":"Currently saved on your device; we can add edit/delete and cloud sync next.",
        "recent.title":"Recent contributions","recent.none":"No contributions yet.","recent.add":"Add one →",
        "footer.brand":"Les NGANYIRA Family","footer.where":"Kigali & worldwide","footer.email":"Email","footer.phone":"Phone"
      },
      fr: {
        brand:"Les NGANYIRA",
        "nav.home":"Accueil","nav.about":"À propos","nav.services":"Services","nav.contribute":"Faire une contribution","nav.terms":"Conditions & Politiques","nav.logout":"Déconnexion",
        "hero.title":"Unis pour notre avenir","hero.tagline":"Épargner. S’entraider. Grandir ensemble.","hero.ctaContribute":"Contribuer","hero.ctaServices":"Voir les services",
        "welcome.title":"Bienvenue",
        "stats.title":"Chiffres clés","stats.totalLabel":"Total des contributions (CAD)","stats.entries":"Entrées :",
        "ann.title":"Annonces","ann.item1":"Rappel d’épargne mensuel : le 25.","ann.item2":"Appel de famille — Dimanche 19:00 (Kigali).",
        "goal.title":"Objectif de la famille","goal.monthTarget":"Objectif mensuel :","goal.raised":"Collecté :","goal.ofTarget":"de l’objectif",
        "how.title":"Comment ça marche","how.step1":"Créez un compte avec e-mail et téléphone.","how.step2":"Contribuez dans n’importe quelle devise (convertie en CAD).","how.step3":"Suivez la progression sur le tableau de bord et l’accueil.",
        "faq.title":"FAQ","faq.q1":"Où sont stockées mes données ?","faq.a1":"Sur votre appareil (LocalStorage). Nous ajouterons la synchronisation en ligne.","faq.q2":"Quelles devises puis-je utiliser ?","faq.a2":"EUR, GBP, CAD, RWF, USD — converties en CAD instantanément.","faq.q3":"Puis-je modifier ou supprimer une contribution ?","faq.a3":"Actuellement local, nous pouvons ajouter modifier/supprimer et le cloud ensuite.",
        "recent.title":"Contributions récentes","recent.none":"Aucune contribution pour l’instant.","recent.add":"Ajouter →",
        "footer.brand":"Famille Les NGANYIRA","footer.where":"Kigali & dans le monde","footer.email":"Email","footer.phone":"Tél."
      }
    };

    function applyLang(lang){
      const dict = TR[lang] || TR.rw;
      document.querySelectorAll("[data-i18n]").forEach(el=>{
        const key = el.getAttribute("data-i18n");
        if (dict[key]) el.textContent = dict[key];
      });
      // Dynamic welcome line
      const welcome = document.getElementById("welcomeTxt");
      if (welcome) {
        if (lang==='en') welcome.textContent = me ? `Logged in as ${email} — Phone: ${me.phone}` : `Logged in as ${email}`;
        else if (lang==='fr') welcome.textContent = me ? `Connecté en tant que ${email} — Tél.: ${me.phone}` : `Connecté en tant que ${email}`;
        else welcome.textContent = me ? `Mwinjiye nka ${email} — Telefone: ${me.phone}` : `Mwinjiye nka ${email}`;
      }
      document.documentElement.setAttribute("lang", lang);
    }

    const langSel = document.getElementById("langSel");
    const savedLang = localStorage.getItem("lng_lang") || "rw";
    langSel.value = savedLang;
    applyLang(savedLang);
    langSel.addEventListener("change", ()=>{
      const lg = langSel.value;
      localStorage.setItem("lng_lang", lg);
      applyLang(lg);
    });

    // ===== Stats & Recent & Goal =====
    function renderStats() {
      const db = getContribs();
      const rows = (db[email] || []);
      const totalCad = rows.reduce((sum, r) => sum + (Number(r.amountCAD)||0), 0);
      document.getElementById("totalCad").textContent = fmtMoney(totalCad);
      document.getElementById("totalCount").textContent = rows.length;
    }

    function renderRecent() {
      const db = getContribs();
      const rows = (db[email] || []).slice().reverse();
      const recent = rows.slice(0, 5);
      const box = document.getElementById("recentList");
      if (!recent.length) {
        box.innerHTML = `<span data-i18n="recent.none">${TR[langSel.value]['recent.none']}</span> <a href="contribute.html" data-i18n="recent.add">${TR[langSel.value]['recent.add']}</a>`;
        return;
      }
      let html = '<div style="overflow:auto;"><table class="simple">';
      html += '<thead><tr><th>Date</th><th>Original</th><th>CAD</th><th>Note</th></tr></thead><tbody>';
      recent.forEach(r => {
        const d = new Date(r.at).toLocaleString();
        html += `<tr>
          <td>${d}</td>
          <td>${fmtMoney(r.amountOriginal)} ${r.currency}</td>
          <td>${fmtMoney(r.amountCAD)} CAD</td>
          <td>${r.note || ""}</td>
        </tr>`;
      });
      html += '</tbody></table></div>';
      box.innerHTML = html;
    }

    const GOAL_TARGET_CAD = 1000; // hindura hano ukoresheje intego y’ukwezi
    function renderGoal() {
      const db = getContribs();
      const rows = (db[email] || []);
      const totalCad = rows.reduce((sum, r) => sum + (Number(r.amountCAD)||0), 0);
      const pct = Math.min(100, (totalCad / GOAL_TARGET_CAD) * 100 || 0);
      document.getElementById("goalTargetLabel").textContent = fmtMoney(GOAL_TARGET_CAD) + " CAD";
      document.getElementById("goalRaised").textContent = fmtMoney(totalCad) + " CAD";
      document.getElementById("goalPct").textContent = pct.toFixed(0) + "%";
      document.getElementById("goalBar").style.width = pct + "%";
    }

    renderStats();
    renderRecent();
    renderGoal();
  </script>
</body>
</html>
