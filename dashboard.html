<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard • Les NGANYIRA</title>
  <style>
    :root { --bg:#f8f9fa; --ink:#111; --muted:#6b7280; --brand:#111; --danger:#b91c1c; }
    *{box-sizing:border-box} body{font-family:Arial, sans-serif; background:var(--bg); margin:0;}
    header{background:var(--brand); color:#fff; padding:12px 16px; display:flex; align-items:center; justify-content:space-between}
    .brand{font-weight:800}
    .controls{display:flex; gap:8px; align-items:center}
    .btn{border:1px solid var(--ink); background:#fff; color:var(--ink); padding:8px 12px; border-radius:10px; cursor:pointer}
    .btn.danger{background:var(--danger); color:#fff; border-color:var(--danger)}
    main{max-width:980px; margin:24px auto; padding:0 16px; text-align:center}
    .hero{background:#fff; border:1px solid #e5e7eb; border-radius:14px; overflow:hidden; box-shadow:0 6px 20px rgba(0,0,0,.06)}
    .hero img{width:100%; height:auto; display:block}
    .pad{padding:16px}
    .muted{color:var(--muted)}
    footer{margin-top:24px; background:var(--brand); color:#fff; text-align:center; padding:12px}
    .row{display:flex; gap:8px; justify-content:center; flex-wrap:wrap}
  </style>
</head>
<body>

<header>
  <div class="brand" id="title">Welcome to Les NGANYIRA</div>
  <div class="controls">
    <span id="userName" class="muted" style="color:#fff;opacity:.9"></span>
    <button id="langBtn" class="btn">Kinyarwanda</button>
    <button id="logoutBtn" class="btn danger">Logout</button>
  </div>
</header>

<main>
  <div class="hero">
    <!-- Shyira foto muri repo: assets/family.jpg (cyangwa uhindure iyi path) -->
    <img src="assets/family.jpg" alt="Les Nganyira family dinner photo" />
    <div class="pad">
      <h2 id="welcomeHeading">We are glad to have you in our family.</h2>
      <p id="welcomeText" class="muted">
        Explore your dashboard and stay connected with the family.
      </p>
      <div class="row">
        <a class="btn" href="index.html" id="homeBtn">Home</a>
        <a class="btn" href="contribute.html" id="contribBtn">Contribute</a>
        <a class="btn" href="profile.html" id="profileBtn">Profile</a>
      </div>
    </div>
  </div>
</main>

<footer>
  <p id="footerText">© 2025 Les NGANYIRA. All rights reserved.</p>
</footer>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script>
  // Firebase config (yawe nyayo)
  const firebaseConfig = {
    apiKey: "AIzaSyA5su24dQrXZUrsZAtUOTptDbPQ2tT6iig",
    authDomain: "lesnganyira.firebaseapp.com",
    projectId: "lesnganyira",
    storageBucket: "lesnganyira.firebasestorage.app",
    messagingSenderId: "456037694600",
    appId: "1:456037694600:web:fec39a23af5bcaa3ccb33d",
    measurementId: "G-TWBDL05VYZ"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  // Texts EN/RW
  const i18n = {
    en: {
      title: "Welcome to Les NGANYIRA",
      welcomeHeading: "We are glad to have you in our family.",
      welcomeText: "Explore your dashboard and stay connected with the family.",
      homeBtn: "Home",
      contribBtn: "Contribute",
      profileBtn: "Profile",
      footerText: "© 2025 Les NGANYIRA. All rights reserved.",
      langBtn: "Kinyarwanda",
      logout: "Logout"
    },
    rw: {
      title: "Murakaza neza muri Les NGANYIRA",
      welcomeHeading: "Twishimiye ko mwinjiye mu muryango wacu.",
      welcomeText: "Reba dashboard yawe kandi uhorane n’umuryango ku murongo.",
      homeBtn: "Ahabanza",
      contribBtn: "Iturize",
      profileBtn: "Umwirondoro",
      footerText: "© 2025 Les NGANYIRA. Uburenganzira bwose burabitswe.",
      langBtn: "English",
      logout: "Sohoka"
    }
  };

  // Apply language
  function applyLang(lang) {
    const t = i18n[lang] || i18n.en;
    document.getElementById('title').textContent = t.title;
    document.getElementById('welcomeHeading').textContent = t.welcomeHeading;
    document.getElementById('welcomeText').textContent = t.welcomeText;
    document.getElementById('homeBtn').textContent = t.homeBtn;
    document.getElementById('contribBtn').textContent = t.contribBtn;
    document.getElementById('profileBtn').textContent = t.profileBtn;
    document.getElementById('footerText').textContent = t.footerText;
    document.getElementById('langBtn').textContent = t.langBtn;
    document.getElementById('logoutBtn').textContent = (t.logout);
    // Save preference
    localStorage.setItem('les_lang', lang);
    // Update <html lang="">
    document.documentElement.setAttribute('lang', lang === 'rw' ? 'rw' : 'en');
  }

  // Init language (remember choice or auto-detect)
  const saved = localStorage.getItem('les_lang');
  const initialLang = saved || (navigator.language || '').toLowerCase().startsWith('rw') ? 'rw' : 'en';
  applyLang(saved ? saved : initialLang);

  // Toggle language
  document.getElementById('langBtn').addEventListener('click', () => {
    const current = localStorage.getItem('les_lang') || 'en';
    applyLang(current === 'en' ? 'rw' : 'en');
  });

  // Auth check (must be logged in & verified)
  auth.onAuthStateChanged(async (user) => {
    if (!user) {
      location.href = 'signin.html';
      return;
    }
    await user.reload();
    if (!user.emailVerified) {
      sessionStorage.setItem('verifyEmailHint', user.email || '');
      location.href = 'verify.html';
      return;
    }
    // Show name
    document.getElementById('userName').textContent = user.displayName ? `• ${user.displayName}` : `• ${user.email}`;
  });

  // Logout
  document.getElementById('logoutBtn').addEventListener('click', async () => {
    await auth.signOut();
    location.href = 'signin.html';
  });
</script>
</body>
</html>
